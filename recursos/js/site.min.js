'use strict';$(document).ready(function(){$("#formFileMultiple").change(function(){0==$(this).prop("files").length?$("#exportBtn").prop("disabled",!0):$("#exportBtn").prop("disabled",!1)});$("#exportBtn").click(async function(){$("#exportBtn").prop("disabled",!0);$("#msjAlert").empty();var c=$("#formFileMultiple").prop("files");if(0==c.length){var a=AlertDiv("Debe Seleccionar Al menos un Archivo JSON");$("#msjAlert").append(a);$("#formFileMultiple").focus();$("#exportBtn").prop("disabled",!1)}else{var d=
$("#filename").val();if(isNullOrEmpty(d))a=AlertDiv("Ingrese un nombre para el archivo"),$("#msjAlert").append(a),$("#exportBtn").prop("disabled",!1),$("#filename").focus();else{d=[];try{for(var b=0;b<c.length;b++){let e=await readFileAsText(c[b]),f=JSON.parse(e);d.push(f)}}catch(e){a=AlertDiv("Los archivos JSON no tienen la estructura esperada. "+e);$("#msjAlert").append(a);$("#exportBtn").prop("disabled",!1);return}c=[];for(b=0;b<d.length;b++)try{a=d[b],c.push({Correlativo:`${b+1}`,FechaEmision:a.identificacion.fecEmi,
NumeroUnicoComprobante:a.identificacion.codigoGeneracion,NumeroComprobante:a.identificacion.numeroControl,NumeroRegistro:a.emisor.nrc,NumeroSerie:a.selloRecibido||a.respuestaHacienda.selloRecibido,NIT:a.emisor.nit,NombreProveedor:a.emisor.nombre,ComprasExentaInterna:a.resumen.totalExenta,ComprasExentaExterna:0,ComprasGrabadasInterna:a.resumen.totalGravada,ComprasGrabadasExterna:0,CreditoFiscal:0,Percepcion:0,TotalCompras:a.resumen.montoTotalOperacion,ComprasSujetosExcluidos:a.resumen.descuNoSuj})}catch(e){a=
AlertDiv("Los archivos JSON no tienen la estructura esperada. "+e);$("#msjAlert").append(a);$("#exportBtn").prop("disabled",!1);return}console.log("JSON Tabla de excel");console.log(JSON.stringify(c));TabularJson(c);$("#divTable").empty();$("#exportBtn").prop("disabled",!1);$("#formFileMultiple").val(null);$("#filename").val(null)}}});$("#exportBtn").prop("disabled",!1);$("#formFileMultiple").val(null);$("#filename").val(null)});
